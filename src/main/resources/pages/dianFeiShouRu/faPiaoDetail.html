<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/js/layui/css/layui.css">
    <link rel="stylesheet" href="/static/css/common.css"/>
    <!--[if lte IE 8]>
    <script src="/static/js/respond.min.js"></script>
    <![endif]-->
    <title></title>
</head>

<body>
<div class="layui-card">

    <div class="layui-card-body">
        <form class="layui-form search-form">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">ID</label>
                    <div class="layui-input-inline">
                        <input type="text" id="id" th:value=${dlYkfpMain.id} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">单据号</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.djh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">分机号</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.fjh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
            </div>

            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">开票终端号</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.kpzdh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>

                <div class="layui-inline">
                    <label class="layui-form-label">开票类型</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value="${dlYkfpMain.kplx}" autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>

                <div class="layui-inline">
                    <label class="layui-form-label">发票种类</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value="${dlYkfpMain.fpzl}" autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>


            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">销方名称</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.xfmc} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">销方税号</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.xfsh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">销方地址电话</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.xfdzdh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">销方银行账号</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.xfyhzh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">价税合计</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.jshj} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>

            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">合计金额</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.hjje} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">合计税额</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.hjse} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">开票时间</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.kpsj} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">购方名称</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.gfmc} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">购方税号</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.gfsh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">购方地址电话</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.gfdzdh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">购方银行账号</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.gfyhzh} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">开票人</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.kpr} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">收款人</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.skr} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">复核人</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.fhr} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">发票代码</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.fpdm} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">发票号码</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.fphm} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">原发票代码</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.yfpdm} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">原发票号码</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.yfphm} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">业务类型</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.ywlx} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">企业名称</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.enterpriseName} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">操作员名称</label>
                    <div class="layui-input-inline">
                        <input type="text" th:value=${dlYkfpMain.employeeName} autocomplete="off" class="layui-input"
                               readonly="readonly">
                    </div>
                </div>

            </div>
        </form>
        <table id="tableName" lay-filter="test" class="layui-table">
            <tr>
                <td>商品名</td>
                <td>商品单位</td>
                <td>商品规格型号</td>
                <td>商品数量</td>
                <td>商品税率</td>
                <td>商品含税金额</td>
            </tr>
            <tr th:each="del: ${dlYkfpDels}">
                <td th:text="${del['xmmc']}"></td>
                <td th:text="${del['hsje']}"></td>
                <td th:text="${del['hsdj']}"></td>
                <td th:text="${del['se']}"></td>
                <td th:text="${del['sl']}"></td>
                <td th:text="${del['xmsl']}"></td>
            </tr>
        </table>
        <button type="button" id="chongHongOrZuoFei" class="layui-btn layui-btn-danger layui-btn-sm">冲红/作废</button>
    </div>
</div>
<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/layui/layui.js"></script>
<script src="/static/js/common.js"></script>
<script>
    var table = null;
    var layer = null;
    layui.use(['table', 'form', 'layer'], function () {
        table = layui.table;
        layer = layui.layer;


    });
    var active = {
        ajaxPost: function (url) {// ajax post 请求
            var indexLoading;
            $.ajax({
                url: url,
                type: 'post',
                dataType: 'json',
                async: false,//开启同步
                beforeSend: function () {
                    indexLoading = layer.load(2, {time: 1500, shade: [0.3, '#000']});
                },
                success: function (rlt) {
                    console.log(rlt);
                    if (rlt.status == '200') {
                        layer.close(indexLoading);
                        layer.alert(rlt.msg, {icon: 1, title: '温馨提示'});
                        layer.msg(rlt.msg, {icon: 1, time: 1000, title: '温馨提示'});
                        active.search();
                    } else {
                        layer.close(indexLoading);
                        layer.alert(rlt.msg, {icon: 2, title: '温馨提示'});
                    }
                },
                error: function (rlt) {
                    layer.close(indexLoading);
                    layer.alert(rlt.msg, {icon: 2, title: '温馨提示'});
                }
            })
        }
    }

    $('#chongHongOrZuoFei').on('click', function () {
        layer.confirm('确认冲红/作废该张发票？', function (index) {
            var url = "/noc/wtdj/chongHongOrZuoFei?id=" + $("#id").val();
            active.ajaxPost(url);
            layer.close(index);
            initTable();
        });
    });

</script>

</body>

</html>